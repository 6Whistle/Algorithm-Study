SELECT fh.FLAVOR 
FROM (SELECT * FROM FIRST_HALF WHERE TOTAL_ORDER > 3000) fh
JOIN (SELECT * FROM ICECREAM_INFO WHERE INGREDIENT_TYPE = 'fruit_based') ii
ON fh.FLAVOR = ii.FLAVOR;
